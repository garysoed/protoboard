<base href=".">

<link rel="import" href="di.html">
<link rel="import" href="service/config.html">

<style>
    /* TODO(gs): Move this to myth? */
  @import url(http://fonts.googleapis.com/css?family=Roboto);

  body {
    background-color: var(--color-background);
    color: var(--color-font);
    font-family: var(--font);
    font-size: small;
  }

  p {
    margin-after: .5em;
    margin-before: .5em;
  }

  .pb-trbl-fit,
  * /deep/ .pb-trbl-fit {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
</style>

<script>
DI
    .bind('$registry', Registry => new Registry())
    .bind('pb_Bootstrap', (
      $registry,
      opt_Bag,
      opt_Card,
      opt_Dice,
      opt_Deck,
      opt_Hand,
      opt_ui_Preview,
      opt_ui_Previewer,
      opt_Rect,
      opt_RectGrid,
      opt_ui_Template,
      opt_Token,
      Config,
      Utils) => {
  return {
    run(document) {
      document.addEventListener('DOMContentLoaded', () => {
        $registry.register(document, Config);

        let tags = Utils.
            toArray(document.querySelectorAll(':unresolved')).
            map(el => el.tagName.toLowerCase());
        let tagSet = new Set(tags);
        for (let tag of tagSet) {
          console.warn(`Element ${tag} is unresolved`);
        }
      });
    }
  };
});
</script>
