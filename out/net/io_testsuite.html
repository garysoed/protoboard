<html><head><base href="..">

<link rel="import" href="testbase.html">
<link rel="import" href="third_party/di.html">

<script>"use strict";

DIJS.bind("pb.net.IOTestSuite", function (require) {

  var j = require("jasmine");

  function IOTestSuite(ctor, triggerUpdate) {
    var io = undefined;

    beforeEach(function () {
      io = new ctor();
    });

    describe("triggerUpdate", function () {
      it("should call listener for update", function () {
        var listener = j.createSpy("listener");
        io.listen(listener);
        triggerUpdate(io, "path", { a: 1 });
        expect(listener).toHaveBeenCalledWith("path", { a: 1 });
      });
    });

    describe("set and get", function () {
      it("should return a promise that is resolved after setting the value", function (done) {
        io.set("/path", 2).then(function () {
          return io.get("/path");
        }).then(function (value) {
          expect(value).toEqual(2);
        }).then(done);
      });
    });
  }

  return IOTestSuite;
});</script>
</head><body></body></html>