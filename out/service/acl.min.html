<html><head><base href="..">

<link rel="import" href="check.html">
<link rel="import" href="service/state.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="utils.html">

<script>"use strict";var _slicedToArray=function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var e,n=[],a=t[Symbol.iterator]();!(e=a.next()).done&&(n.push(e.value),!r||n.length!==r););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_defineProperty=function(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0})},_createClass=function(){function t(t,r){for(var e in r){var n=r[e];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(t,r)}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),_classCallCheck=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")};DI.prefix("pb").bind("service.Acl",{Check:"=",Utils:"=",State:"service.=",TEST_MODE:"/=?"},function(t){var r="pb-acl-",e="currentPlayer",n=Symbol("enabledMap"),a=Symbol(),i=Symbol(),o=Symbol(),l=(Symbol(),Symbol()),u=Symbol(),s=Symbol(),c=Symbol("update"),f=new Map,y=function(){function t(r){_classCallCheck(this,t),this[i]=r,this[a]=new Set}return _createClass(t,{contains:{value:function(r){if(r===this[i])return!0;var e=!0,n=!1,o=void 0;try{for(var l,u=this[a][Symbol.iterator]();!(e=(l=u.next()).done);e=!0){var s=l.value,c=s instanceof t?s.contains(r):s===r;if(c)return!0}}catch(f){n=!0,o=f}finally{try{!e&&u["return"]&&u["return"]()}finally{if(n)throw o}}return!1}},add:{value:function(t){this[a].add(t)}}}),t}(),v=Object.defineProperties(function(){var e={};return _defineProperty(e,l,new Set),_defineProperty(e,s,function(t){t[n]&&t[n].clear()}),_defineProperty(e,c,function(e){var a=this;e[n]||(e[n]=new Map);var i=!0,o=!1,l=void 0;try{for(var u,s=t.Utils.toMap(e.attributes)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c;(function(){c=_slicedToArray(u.value,2);var i=c[0],o=c[1];if(!i.startsWith(r))return"continue";var l=i.substring(r.length),s=t.Check(o.value).isList().orUse(null),y=null===s||0===s.length||s.some(function(t){return f.has(t)?f.get(t).contains(a.currentPlayer):t===a.currentPlayer});e[n].set(l,y),a.isActionEnabled(e,l).then(function(t){e.classList.toggle("pb-acl-"+l,t)})})()}}catch(y){o=!0,l=y}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw l}}}),_defineProperty(e,u,function(t){var e=!0,n=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var l=i.value,u=l.attributeName;u.startsWith(r)&&(this[s](l.target),this[c](l.target))}}catch(f){n=!0,a=f}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw a}}}),_defineProperty(e,"registerElement",function(t){return this[l].add(t),t[o]||(t[o]=new MutationObserver(this[u].bind(this)),t[o].observe(t,{attributes:!0})),this[c](t),this}),_defineProperty(e,"isActionEnabled",function(t,r){var e=t.parentElement?this.isActionEnabled(t.parentElement,r):Promise.resolve(!0);t[n]||(t[n]=new Map,this[c](t));var a=!t[n].has(r)||t[n].get(r);return Promise.all([e,a]).then(function(t){var r=_slicedToArray(t,2),e=r[0],n=r[1];return e&&n})}),_defineProperty(e,"addGroup",function(t){for(var r=arguments.length,e=Array(r>1?r-1:0),n=1;r>n;n++)e[n-1]=arguments[n];var a=new y(t),i=!0,o=!1,l=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;a.add(f.has(c)?f.get(c):c)}}catch(v){o=!0,l=v}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw l}}return f.set(t,a),this}),e}(),{currentPlayer:{get:function(){return t.State.get(e)},set:function(r){t.State.put(e,r);var n=!0,a=!1,i=void 0;try{for(var o,u=this[l][Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var f=o.value;this[s](f)}}catch(y){a=!0,i=y}finally{try{!n&&u["return"]&&u["return"]()}finally{if(a)throw i}}var v=!0,h=!1,d=void 0;try{for(var b,p=this[l][Symbol.iterator]();!(v=(b=p.next()).done);v=!0){var f=b.value;this[c](f)}}catch(y){h=!0,d=y}finally{try{!v&&p["return"]&&p["return"]()}finally{if(h)throw d}}},configurable:!0,enumerable:!0}});return t.TEST_MODE&&(v.Group=y,v.GROUPS=f),v});</script>
</head><body></body></html>