<!DOCTYPE html>
<html>
<head>
  <base href="../..">
  <title>Context Service Unit Tests</title>
  <link rel="import" href="test/testbase.html">
</head>
<body>
  <script>
    'use strict';

    (function() {
      var expect = chai.expect;
      var _ = spies.Spies;
      var ContextService = pb.service.Context;

      var doc = document.currentScript.ownerDocument;

      describe('Context Service', function() {
        describe('#setActive', function() {
          it('should set the currently active context menu and trigger event', function() {
            var active = {};

            var handler = _.spiedFunction();
            $(ContextService).on(ContextService.EventType.SWITCHED, handler);

            ContextService.setActive(active);
            expect(ContextService.getActive()).to.be.equal(active);
            expect(handler).to.be.called().at.least(1);
          });
        });

        afterEach(function(done) {
          _.reset();
          done();
        })
      });
    })();
  </script>
</body>