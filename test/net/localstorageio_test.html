<!DOCTYPE html>
<html>
<head>
  <base href="..">
  <title>net.LocalStorageIO Unit Tests</title>

  <link rel="import" href="net/io_testsuite.html">
  <link rel="import" href="net/localstorageio.html">
  <link rel="import" href="testbase.html">
  <link rel="import" href="testutils.html">
  <link rel="import" href="third_party/di.html">
</head>
<body>
<script>
DIJS
.run(require => {
  const IOTestSuite = require('pb.net.IOTestSuite');
  const LocalStorageIO = require('pb.net.LocalStorageIO');
  const t = require('pb.t');

  describe('net.LocalStorageIO', () => {
    IOTestSuite(
      LocalStorageIO.bind(null, '/root', window.localStorage),
      (io, path, newData) => {
        t.getPrivateMethod(io, 'onStorageEvent')({
          storageArea: window.localStorage,
          key: `/root${path}`,
          newValue: JSON.stringify(newData)
        });
      });

    afterEach(() => {
      window.localStorage.clear();
    });
  });
});
</script>
</body>
