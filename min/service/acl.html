<html><head><base href="..">

<link rel="import" href="check.html">
<link rel="import" href="service/state.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="utils.html">

<script>"use strict";var _slicedToArray=function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r)){for(var e,n=[],a=r[Symbol.iterator]();!(e=a.next()).done&&(n.push(e.value),!t||n.length!==t););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_defineProperty=function(r,t,e){return Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0})},_createClass=function(){function r(r,t){for(var e in t){var n=t[e];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(r,t)}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),_classCallCheck=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")};DIJS.prefix("pb").bind("service.Acl",function(r,t){var e=r("Check"),n=r("service.State"),a=r("Utils"),i=t("/TEST_MODE"),o="pb-acl-",l="currentPlayer",u=Symbol("enabledMap"),s=Symbol(),c=Symbol(),f=Symbol(),y=(Symbol(),Symbol()),v=Symbol(),h=Symbol(),d=Symbol("update"),b=new Map,p=function(){function r(t){_classCallCheck(this,r),this[c]=t,this[s]=new Set}return _createClass(r,{contains:{value:function(t){if(t===this[c])return!0;var e=!0,n=!1,a=void 0;try{for(var i,o=this[s][Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var l=i.value,u=l instanceof r?l.contains(t):l===t;if(u)return!0}}catch(f){n=!0,a=f}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw a}}return!1}},add:{value:function(r){this[s].add(r)}}}),r}(),m=Object.defineProperties(function(){var r={};return _defineProperty(r,y,new Set),_defineProperty(r,h,function(r){r[u]&&r[u].clear()}),_defineProperty(r,d,function(r){var t=this;r[u]||(r[u]=new Map);var n=!0,i=!1,l=void 0;try{for(var s,c=a.toMap(r.attributes)[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var f;(function(){f=_slicedToArray(s.value,2);var n=f[0],a=f[1];if(!n.startsWith(o))return"continue";var i=n.substring(o.length),l=e(a.value).isList().orUse(null),c=null===l||0===l.length||l.some(function(r){return b.has(r)?b.get(r).contains(t.currentPlayer):r===t.currentPlayer});r[u].set(i,c),t.isActionEnabled(r,i).then(function(t){r.classList.toggle("pb-acl-"+i,t)})})()}}catch(y){i=!0,l=y}finally{try{!n&&c["return"]&&c["return"]()}finally{if(i)throw l}}}),_defineProperty(r,v,function(r){var t=!0,e=!1,n=void 0;try{for(var a,i=r[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var l=a.value,u=l.attributeName;u.startsWith(o)&&(this[h](l.target),this[d](l.target))}}catch(s){e=!0,n=s}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}),_defineProperty(r,"registerElement",function(r){return this[y].add(r),r[f]||(r[f]=new MutationObserver(this[v].bind(this)),r[f].observe(r,{attributes:!0})),this[d](r),this}),_defineProperty(r,"isActionEnabled",function(r,t){var e=r.parentElement?this.isActionEnabled(r.parentElement,t):Promise.resolve(!0);r[u]||(r[u]=new Map,this[d](r));var n=!r[u].has(t)||r[u].get(t);return Promise.all([e,n]).then(function(r){var t=_slicedToArray(r,2),e=t[0],n=t[1];return e&&n})}),_defineProperty(r,"addGroup",function(r){for(var t=arguments.length,e=Array(t>1?t-1:0),n=1;t>n;n++)e[n-1]=arguments[n];var a=new p(r),i=!0,o=!1,l=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;a.add(b.has(c)?b.get(c):c)}}catch(f){o=!0,l=f}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw l}}return b.set(r,a),this}),r}(),{currentPlayer:{get:function(){return n.get(l)},set:function(r){n.put(l,r);var t=!0,e=!1,a=void 0;try{for(var i,o=this[y][Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;this[h](u)}}catch(s){e=!0,a=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw a}}var c=!0,f=!1,v=void 0;try{for(var b,p=this[y][Symbol.iterator]();!(c=(b=p.next()).done);c=!0){var u=b.value;this[d](u)}}catch(s){f=!0,v=s}finally{try{!c&&p["return"]&&p["return"]()}finally{if(f)throw v}}},configurable:!0,enumerable:!0}});return i&&(m.Group=p,m.GROUPS=b),m});</script>
</head><body></body></html>