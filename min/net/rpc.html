<html><head><base href="..">

<link rel="import" href="net/utils.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="third_party/jquery.html">

<script>"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var n,r=[],i=e[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!t||r.length!==t););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createComputedClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.configurable=!0,r.value&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};DIJS.bind("pb.net.Rpc.__ctor__",function(e){var t=e("pb.$"),n=e("pb.net.Utils").normalize,r=Symbol("get"),i=Symbol(),o=Symbol(),u=Symbol("remove"),a=Symbol("set"),l=Symbol("triggerUpdates"),s=Symbol("updateAncestorIndexes"),c=function(){function e(t){_classCallCheck(this,e),this[i]=t,t.listen(this[o].bind(this))}return _createComputedClass(e,[{key:r,value:function(e){var t=this;return this[i].get(e).then(function(i){if(i&&i.$index){var o=[],u=!0,a=!1,l=void 0;try{for(var s,c=i.keys[Symbol.iterator]();!(u=(s=c.next()).done);u=!0)!function(){var i=s.value;o.push(t[r](n(e,i)).then(function(e,t){return[e,t]}.bind(null,i)))}()}catch(f){a=!0,l=f}finally{try{!u&&c["return"]&&c["return"]()}finally{if(a)throw l}}return Promise.all(o).then(function(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var a=o.value,l=_slicedToArray(a,2),s=l[0],c=l[1];t[s]=c}}catch(f){r=!0,i=f}finally{try{!n&&u["return"]&&u["return"]()}finally{if(r)throw i}}return t})}return Promise.resolve(i)})}},{key:o,value:function(e,t){var r=n(e);this[l](r)}},{key:u,value:function(e){var t=this,n=e.split("/"),r=n.pop(),o=[this[i].set(e,null)];return n.length>1&&!function(){var e=n.join("/");o.push(t[i].get(e).then(function(n){return n&&n.$index&&n.keys.indexOf(r)>=0&&n.keys.splice(n.keys.indexOf(r),1),0===n.keys.length?t[u](e):t[i].set(e,n)}))}(),Promise.all(o)}},{key:a,value:function(e,t){var r=[];if(t instanceof Object&&!(t instanceof Array)){r.push(this[i].set(e,{$index:!0,keys:Object.keys(t)}));for(var o in t)r.push(this[a](n(e,o),t[o]))}else r.push(this[i].set(e,t));return Promise.all(r)}},{key:l,value:function(e){for(var n=e.split("/");n.length>1;){var r=n.join("/");r.length>0&&t(this).trigger(n.join("/")),n.pop()}}},{key:s,value:function(e){var t=this,r=[],o=e.split("/"),u=n(o.splice(0,1)[0]),a=!0,l=!1,s=void 0;try{for(var c,f=o[Symbol.iterator]();!(a=(c=f.next()).done);a=!0)!function(){var e=c.value;r.push(t[i].get(u).then(function(e,n,r){return r&&r.$index||(r={$index:!0,keys:[]}),r.keys.indexOf(n)<0&&r.keys.push(n),t[i].set(e,r)}.bind(null,u,e))),u=n(u,e)}()}catch(y){l=!0,s=y}finally{try{!a&&f["return"]&&f["return"]()}finally{if(l)throw s}}return Promise.all(r)}},{key:"add",value:function(e){var t=this,r=n(e);return this[s](e).then(function(){return t[i].get(r)}).then(function(r){r&&r.$index||(r={$index:!0,keys:[]});for(var i=0;r.keys.indexOf(""+i)>=0;)i++;return t.set(n(e,""+i),{}).then(function(){return""+i})})}},{key:"remove",value:function(e){return this[u](n(e))}},{key:"get",value:function(e){return this[r](n(e))}},{key:"set",value:function(e,t){var r=this,i=n(e);return this[s](i).then(function(){return r[a](i,t)})}}]),e}();return c}).bind("pb.net.Rpc",function(e){var t=e("pb.net.IO"),n=e("pb.net.Rpc.__ctor__");return new n(t)});</script>
</head><body></body></html>