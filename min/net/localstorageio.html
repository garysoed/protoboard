<html><head><base href="..">

<link rel="import" href="net/abstractio.html">
<link rel="import" href="net/utils.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="third_party/events.html">

<script>"use strict";var _createComputedClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.configurable=!0,n.value&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};DIJS.bind("pb.net.LocalStorageIO",function(t){var e=t("pb.net.AbstractIO"),r=t("pb.Events"),n=t("pb.net.Utils"),o=Symbol("listeners"),i=Symbol("onStorageEvent"),s=Symbol("root"),a=Symbol("storage"),l=Symbol("unprefix"),u=function(t){function e(){var t=void 0===arguments[0]?"/pb":arguments[0],l=void 0===arguments[1]?window.localStorage:arguments[1];_classCallCheck(this,e),this[o]=[],this[s]=n.normalize(t),this[a]=l,r.of(window,this).on("dom","storage",this[i].bind(this))}return _inherits(e,t),_createComputedClass(e,[{key:i,value:function(t){if(t.storageArea===this[a]&&t.key.startsWith(this[s])){var e=!0,r=!1,n=void 0;try{for(var i,u=this[o][Symbol.iterator]();!(e=(i=u.next()).done);e=!0){var c=i.value;c(this[l](t.key),JSON.parse(t.newValue))}}catch(f){r=!0,n=f}finally{try{!e&&u["return"]&&u["return"]()}finally{if(r)throw n}}}}},{key:l,value:function(t){return t.substring(this[s].length)}},{key:"listen",value:function(t){this[o].push(t)}},{key:"get",value:function(t){return Promise.resolve(JSON.parse(this[a].getItem(n.normalize(this[s],t))))}},{key:"set",value:function(t,e){return this[a].setItem(n.normalize(this[s],t),JSON.stringify(e)),Promise.resolve()}}]),e}(e);return u});</script>
</head><body></body></html>