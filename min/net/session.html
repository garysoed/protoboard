<html><head><base href="..">

<link rel="import" href="net/rpc.html">
<link rel="import" href="net/sync.html">
<link rel="import" href="net/utils.html">
<link rel="import" href="service/state.html">
<link rel="import" href="service/template.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="third_party/events.html">

<script>"use strict";var _createComputedClass=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.configurable=!0,r.value&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),_classCallCheck=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")};DIJS.bind("pb.net.Session.__ctor__",function(n){var t=n("pb.Events"),e=n("pb.net.Sync"),r=Symbol(),u=Symbol(),o=function(){function n(t){_classCallCheck(this,n),this[u]=t}return _createComputedClass(n,[{key:r,value:function(n,r){var u=this;n.get().then(function(o){o.playerCount<=Object.keys(o.players).length&&(t.of(n,u).off("jquery",e.Events.UPDATED),r())})}},{key:"create",value:function(n){var t=void 0===arguments[1]?{}:arguments[1];return this[u].add().then(function(e){return e.set({playerCount:n,players:[],state:t})})}},{key:"get",value:function(n){return this[u].sync(n)}},{key:"join",value:function(n,t){var e=void 0===arguments[2]?{}:arguments[2],r=n.sync("players");return r.add().then(function(n){return n.set({id:t,state:e})}).then(function(){return n})}},{key:"start",value:function(n){var u=this;return new Promise(function(o,a){var s=o.bind(null,n);t.of(n,u).on("jquery",e.Events.UPDATED,u[r].bind(u,n,s)),u[r](n,s)})}}]),n}();return o}).bind("pb.net.Session",function(n){var t=n("pb.net.Session.__ctor__"),e=n("pb.net.Sync");return new t(new e("(root)","/"))});</script>
</head><body></body></html>