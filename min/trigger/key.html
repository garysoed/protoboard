<html><head><base href="..">

<link rel="import" href="service/move.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="third_party/events.html">
<link rel="import" href="trigger/trigger.html">
<link rel="import" href="trigger/triggers.html">

<style>/*.pb-key:hover::shadow #root {
    outline: 6px dashed var(--color-highlight);
    outline-offset: -6px;
  }*/</style>

<script>"use strict";var _inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_createComputedClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.configurable=!0,n.value&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};DIJS.bind("pb.trigger.Key.__service__.__ctor__",function(e){var t=e("pb.Events"),r=e("pb.service.Move"),n=Symbol("document"),i=Symbol("hoveredEls"),o=Symbol("onKeyPress"),s=function(){function e(){_classCallCheck(this,e),this[i]=new Map,this[n]=null}return _createComputedClass(e,[{key:o,value:function(e){for(var t=String.fromCharCode(e.keyCode),o=this[n].elementFromPoint(r.mouseX,r.mouseY),s=!1;null!==o&&!s;){var u=this[i].get(o);if(u){var a=u.get(t);if(a){var l=!0,c=!1,f=void 0;try{for(var y,h=a[Symbol.iterator]();!(l=(y=h.next()).done);l=!0){var v=y.value;v.trigger(o);var g=o.getBoundingClientRect();(r.movedElements.has(o)||g.left>r.mouseX||g.right<r.mouseX||g.top>r.mouseY||g.bottom<r.mouseY)&&this[i]["delete"](o),s=!0;break}}catch(b){c=!0,f=b}finally{try{!l&&h["return"]&&h["return"]()}finally{if(c)throw f}}}}o=o.parentElement}}},{key:"init",value:function(e){this[n]=e,t.of(e.body,this).on("dom","keypress",this[o].bind(this))}},{key:"add",value:function(e,t,r){this[i].has(e)||this[i].set(e,new Map);var n=this[i].get(e);n.get(t)||n.set(t,new Set),n.get(t).add(r)}},{key:"remove",value:function(e){this[i]["delete"](e)}},{key:"clear",value:function(){this[i].clear()}},{key:"hoveredEls",get:function(){return this[i]}}]),e}();return s}).bind("pb.trigger.Key.__service__",function(e){var t=e("pb.trigger.Key.__service__.__ctor__");return new t}).bind("pb.trigger.Key",function(e){var t=e("pb.$registry"),r=e("pb.Events"),n=(e("pb.service.Move"),e("pb.trigger.Key.__service__")),i=e("pb.trigger.Trigger"),o=e("pb.trigger.Triggers"),s=(Symbol(),Symbol("key")),u=Symbol(),a=Symbol("onMouseLeave"),l=function(e){function t(e){_classCallCheck(this,t),this[s]=e}return _inherits(t,e),_createComputedClass(t,[{key:u,value:function(e,t){n.add(t,this[s],e)}},{key:a,value:function(e){n.remove(e)}},{key:"on",value:function(e,t){r.of(e,this).on("dom","mouseenter",this[u].bind(this,t,e)).on("dom","mouseleave",this[a].bind(this,e)),e.classList.add("pb-key")}},{key:"off",value:function(e){r.of(e,this).off(),e.classList.remove("pb-key")}},{key:"toString",value:function(){return"key-"+this[s]}},{key:"helpText",get:function(){return this[s]}}]),t}(i);return o.register(function(e){return"key-"===e.substring(0,"key-".length)?new l(e.substring("key-".length)):void 0}),t.runAtRegister(function(e){n.init(e)}),l});</script>
</head><body></body></html>