<html><head><base href="..">

<link rel="import" href="check.html">
<link rel="import" href="service/log.html">
<link rel="import" href="third_party/di.html">
<link rel="import" href="third_party/jquery.html">
<link rel="import" href="trigger/triggers.html">
<link rel="import" href="utils.html">

<script>"use strict";var _createClass=function(){function t(t,i){for(var r in i){var e=i[r];e.configurable=!0,e.value&&(e.writable=!0)}Object.defineProperties(t,i)}return function(i,r,e){return r&&t(i.prototype,r),e&&t(i,e),i}}(),_classCallCheck=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")};DI.bind("CustomEvent",{},function(){return CustomEvent}).prefix("pb").bind("ability.Ability",{$:"/=",Check:"=",CustomEvent:"/=",Log:"service.=",Triggers:"trigger.="},function(t){var i=Symbol(),r=Symbol("defaultTrigger"),e=Symbol("triggerMap"),n=function(){function n(t,e){_classCallCheck(this,n),this[i]=t,this[r]=e||null}return _createClass(n,{init:{value:function(i){void 0===t.$(i).attr(this.attrTrigger)&&this[r]&&t.$(i).attr(this.attrTrigger,this[r].toString()),this.updateConfig(i)}},updateConfig:{value:function(i){i[e]||(i[e]=new Map);var r=t.$(i).attr(this.attrTrigger);if(!i[e].has(this)||r!==i[e].get(this).toString()){i[e].has(this)&&i[e].get(this).off(i);var n=t.Triggers.parse(t.$(i).attr(this.attrTrigger));n&&n.on(i,this),i[e].set(this,n)}}},trigger:{value:function(i){t.Log.log(this.attrName,t.$(i).attr("pb-id")),this.isEnabled(i)&&(i.dispatchEvent(new t.CustomEvent(this.attrName,{detail:{ability:this}})),this.doTrigger(i))}},doTrigger:{value:function(t){throw new Error("Unimplemented")}},getTrigger:{value:function(t){return t[e]?t[e].get(this):null}},isEnabled:{value:function(i){return t.Check(t.$(i).attr(this.attrName)).isBoolean().orUse(!1)}},attrName:{get:function(){return this[i]}},attrTrigger:{get:function(){return""+this[i]+"-on"}},defaultTrigger:{get:function(){return this[r]},set:function(t){this[r]=t}}}),n}();return n});</script>
</head><body></body></html>